{% extends "base.html" %}

{% load crispy_forms_tags %}
{% load django_markdown %}

{% load staticfiles %}
{% block extra_js %}
  <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/jquery-ui.min.js"></script>
{% endblock extra_js %}

{% block title %}i: {% if not translation %}{{ object.name }}{% else %}{{ translation.name }}{% endif %}{% endblock title %}

{% block content %}

<script>
function showMore(){
    document.getElementById("stats").innerHTML = "<span onmouseout='showLess()'>[<u>assumed</u> {{ object.total_assumed|floatformat:2 }} h, <u>donated</u> {{ object.total_donated|floatformat:2 }} ħ, <u>claimed</u> {{ object.total_claimed|floatformat:2 }}, <u>matched</u> {{ object.total_matched|floatformat:2}} ḥ]</span>";
}

function showLess(){
    document.getElementById("stats").innerHTML = "<span onmouseover='showMore()'><b>[<u>needs ${{ object.get_remain_usd|floatformat:2 }} for funding {{ object.not_funded_hours|floatformat:2}} hours</u>]</b></span>";
}
</script>

<script>
$(document).ready( function() {
    $(".tiptext").mouseover(function() {
        $(this).children(".description").show();
    }).mouseout(function() {
        $(this).children(".description").hide();
    });
});
</script>

<div class="panel panel-default box col-sm-12 col-md-7">
<div class="panel-body">
    <div class="alignleft"><a href="#id_name" onclick="getfocus()"><i class="fa fa-share"></i></a></div>
      <div class="alignright" id="stats">
        <span onmouseover="showMore()"><b>[<u>needs ${{ object.get_remain_usd|floatformat:2 }} for funding {{ object.not_funded_hours|floatformat:2}} hours</u>]</b></span>
      </div>
      <div style="clear:both;"></div>
      <div align="right">
        <span class="tiptext">[<u>super-equity</u>: {{ object.get_equity|floatformat:2 }}% ḥ]
        <div class="description" align="left">A fixed percentage of all the future <b>ḥ</b> (<u>time and money spent</u>), which indicates how much idea creator owns of all projects under this idea.</div>
        </span>
      </div>

{% for goal in object.goal.all %}
want: <a href="{% url "goal-detail" goal.pk %}">{{ goal }}</a></li>
{% endfor %}<br/>
translations: 
    <!-- translations -->
    <a href="{% url "idea-detail" object.id %}">
        [{{object.language.language_code}}]
    </a>
    {% for translation in translations %}
    {% if translation.language.language_code %}
    <a href="{% url "idea-detail" object.id %}?lang={{translation.language.language_code }}">
        [{{ translation.language.language_code }}]
    </a>
    {% endif %}
    {% endfor %}
    <a href="{{ translate_url }}">[+]</a>
    <!-- /translations -->

<h1>{% if not translation %}{{ object.name }}{% else %}{{ translation.name}}{% endif %}</h1>
<h2 style="font-size:22px;">{% if not translation %}{{ object.summary }}{% else %}{{ translation.summary}}{% endif %}</h2>
{% if object.user == request.user %}[<a href="{% if not translation %}{% url "idea-update" object.pk %}{% else %}{% url "update-translation" translation.pk %}{% endif %}">edit</a>, <a href="{% if not translation %}{% url "idea-delete" object.pk %}{% else %}{% url "delete-translation" translation.pk %}{% endif %}">delete</a>]{% endif %}
<br/>
<br/>

{% if not translation %}
{{object.description|markdown}}
{% else %}
{{translation.description|markdown}}
{% endif %}
<div align="right">--[<a href="{% url 'user-detail' object.user.username %}">{{object.user}}</a>], {{object.created_at}}</div>

{% if object.personal %}<i class="fa {% if object.user == request.user %}fa-lock{% else %}fa-flag{% endif %}"></i> [<u>shared with:</u> {% for member in object.sharewith.all %} <a href="{% url 'user-detail' member.username %}">{{ member.username }}</a>{%if not forloop.last%}, {%endif%}{% endfor %}]{% endif %}
</div>


<div class="panel-heading">Plans</div>
<div class="panel-body">
{% for object in plan_list %}
    <ul class="list-group">
      <li class="list-group-item">
         <a href="{% url "plan-detail" object.pk %}">{{object.name}}</a> 
         <p>{{object.situation}}</p>
      </li>
    </ul>
{% endfor %}
<a href="{% url "plan-create" object.pk %}">+New Plan</a>
</div>
</div>

{# Include comment list with transactions #}
{% include "comment/list.html" %}

{% endblock content %}
